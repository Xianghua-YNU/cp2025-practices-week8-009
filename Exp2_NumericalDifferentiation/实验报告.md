# 实验二：数值微分的误差权衡

## 1. 实验目的
- 理解数值微分中截断误差与舍入误差的权衡关系
- 观察有限差分法计算导数时的误差变化规律
- 分析步长对数值微分精度的影响
- 确定最优步长范围

## 2. 实验方法
### 2.1 理论基础
数值微分是通过有限差分近似导数的计算方法。本实验实现了两种差分方法：
- 前向差分法: $f'(x) \approx \frac{f(x+\delta) - f(x)}{\delta}$
- 中心差分法: $f'(x) \approx \frac{f(x+\delta) - f(x-\delta)}{2\delta}$

### 2.2 测试函数
本实验使用函数 $f(x) = x(x-1)$，其解析导数为 $f'(x) = 2x - 1$。

### 2.3 实验步骤
1. 实现前向差分和中心差分函数
2. 在 $x=1$ 点计算不同步长下的数值导数
3. 计算数值导数与解析导数的相对误差
4. 绘制误差-步长关系图（对数坐标）
5. 分析最优步长和收敛阶数

## 3. 实验结果
### 3.1 数据表格
| 步长(δ) | 前向差分值 | 中心差分值 | 解析解 | 前向差分相对误差 | 中心差分相对误差 |
|---------|------------|------------|--------|------------------|------------------|
| 1.00e-02 |    1.010000        |     0.999833       | 1.0    | 1.000000e-02                |  8.881784e-16                |
| 1.00e-04 |    1.000100        |   0.99999983         | 1.0    | 1.000000e-04                 |  1.100231e-13                |
| 1.00e-06 |    1.00000100        |   1.00000000         | 1.0    | 9.999177e-07                |  2.675549e-11                |
| 1.00e-08 |    1.00000001        |    1.00000000        | 1.0    | 3.922529e-09              |     5.263561e-10             |
| 1.00e-10 |    1.00000000        |   1.00000000         | 1.0    |  8.284037e-08                |   8.274037e-08               |              
| 1.00e-12 |    1.00000000        |    1.00000000        | 1.0    | 8.890058e-05                 |    3.338943e-05              |
| 1.00e-14 |    0.99920072        |    0.99920072        | 1.0    |   7.992778e-04               |    7.992778e-04              |

### 3.2 误差-步长关系图
（![屏幕截图 2025-04-18 135904](https://github.com/user-attachments/assets/31094318-2004-4181-8716-579d0fab7222)
）

## 4. 分析与讨论
### 4.1 误差来源分析
数值微分中存在两种主要误差来源：
- **截断误差**：由于使用有限差分近似导数定义引入的误差，通常随步长减小而减小
- **舍入误差**：由于计算机浮点数表示的有限精度引入的误差，通常随步长减小而增大

（分析实验中观察到的截断误差和舍入误差的表现）
前向差分（蓝色曲线）：

在大步长区域（δ > 1e-5）误差随步长线性减小，符合一阶收敛特性

在步长δ ≈ 1e-8时达到最小误差约2.2e-8

当δ < 1e-8时误差迅速增大，呈现舍入误差主导特征

中心差分（橙色曲线）：

在大步长区域（δ > 1e-4）误差随步长平方减小，符合二阶收敛特性

在步长δ ≈ 1e-6时达到最小误差约2.4e-12

当δ < 1e-10时误差开始明显增大

参考线对比：

前向差分误差曲线与O(h)参考线平行

中心差分误差曲线与O(h²)参考线平行

验证了两种方法的理论收敛阶数

### 4.2 前向差分与中心差分的比较
（比较两种方法的精度差异，并解释原因）
![屏幕截图 2025-04-18 140507](https://github.com/user-attachments/assets/6a3df2f6-cb53-458b-91fb-5bd1ec43c3f3)


### 4.3 最优步长分析
（分析实验中观察到的最优步长，并解释为什么存在最优步长）
![屏幕截图 2025-04-18 140549](https://github.com/user-attachments/assets/e663f0aa-40c6-4f1f-9496-c0a8ee96515b)


### 4.4 收敛阶数分析
（分析两种方法的收敛阶数，并与理论预期进行比较）
![屏幕截图 2025-04-18 140630](https://github.com/user-attachments/assets/20aa1a65-361a-4807-82be-a99d9910986a)


## 5. 实验结论
（总结本实验的主要发现，特别是关于误差权衡、最优步长和不同差分方法的优缺点）
误差权衡：数值微分存在最优步长，由截断误差与舍入误差的平衡决定

方法比较：中心差分比前向差分精度高2个数量级，但需要更精细的步长控制

收敛验证：前向差分和中心差分分别符合一阶和二阶收敛理论

实践指导：

推荐使用中心差分法以获得更高精度

建议步长选择在1e-6到1e-8之间

需要根据具体函数特性调整最优步长

## 附录：核心代码片段
```python
# 前向差分法实现
def forward_diff(f, x, delta):
    return (f(x + delta) - f(x)) / delta

# 中心差分法实现
def central_diff(f, x, delta):
    return (f(x + delta) - f(x - delta)) / (2 * delta)

# 计算误差的代码
# ...

# 绘制误差-步长关系图的代码
# ...
```
